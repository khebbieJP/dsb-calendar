[tools]
python = "3.11"

[env]
_.python.venv = { path = ".venv", create = true }

[tasks.install]
description = "Install Python dependencies"
run = "uv pip install -r requirements.txt"

[tasks.test]
description = "Run automated tests"
depends = ["install"]
run = "pytest test_*.py -v"

[tasks.convert]
description = "Convert DSB PDF ticket to ICS calendar file (usage: mise run convert -- <input.pdf> [output.ics])"
depends = ["install"]
run = "python cli.py $@"

[tasks.example]
description = "Run example conversion with Billet.pdf"
depends = ["install"]
run = "python cli.py Billet.pdf DSB_Rejse_Example.ics"

[tasks.web]
description = "Start Flask web application"
depends = ["install"]
run = "python app.py"

[tasks.dev]
description = "Start Flask web application in debug mode"
depends = ["install"]
env = { FLASK_DEBUG = "true" }
run = "python app.py"

[tasks.clean]
description = "Clean up generated files and cache"
run = """
rm -f *.ics
rm -rf .pytest_cache
rm -rf __pycache__
find . -name "*.pyc" -delete
echo "Cleaned up generated files and cache"
"""
